<!DOCTYPE html>
<html>
  <head>
    <title>Laboratory</title>
    <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet">
    <style>
      body {
        font-family: arial;
      }

      .splash-screen-box {
        width: 400px;
        height: 300px;
        background-color: white;
        margin: 200px auto;
        text-align: center;
        border: 1px solid gray;
      }

      #file-select label {
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        text-align: center;
      }

      #file-select input {
        /* Remove ugly upload button */
        position: fixed;
        top: -1000px;
      }

      #loading-screen-container {
        display: none; /* Becomes visible when loading */
        width: 800px;
      }
      #loading-screen-table {
        width: 100%;
        height: 100%;
        vertical-align: top;
        text-align: left;
      }

      #top-bar {
        position: fixed;
        top: 0px;
        left: 0px;
        display: flex;
        justify-content: space-between;
        background-color: white;
        border-bottom: 1px solid black;
        width: 100%;
        height: 45px;
        line-height: 45px;
      }

      #top-bar-filler {
        /* Prevents main content from hiding under the top bar */
        height: 45px;
      }

      #bottom-filler {
        /* Adds space at the bottom the page so when the type view opens near
           the bottom of the code view, it does not resize the page */
        height: 300px;
      }

      #main-content {
        position: absolute;
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
        border: 0;
        visibility: hidden; /* Becomes visible when kernel file is loaded. */
        overflow-x: hidden;
      }

      /*  Search box  */
      #search-input-container {
        display: inline-block;
        width: 800px;
      }
      #search-input {
        font-size: 16pt;
        font-family: arial;
        width: 800px;
        border: none;
      }
      #search-input-suggestions {
        position: absolute;
        background-color: white;
        width: 800px;
      }
      #search-input-suggestions select {
        width: 800px;
        font-family: arial;
        font-size: 12pt;
      }

      /*  Backtracker  */
      #backtracker-container {
        display: inline-block;
        height: 100%;
      }
      #backtracker-progress {
        width: 300px;
      }
      #backtracker-title {}

      /* Track escape checkbox */
      #track-escape-container {
        display: inline-block;
        height: 100%;
        min-width: 100px;
        font-size: 10pt;
        margin-right: 12px;
        margin-left: 12px;
        vertical-align: center;
      }
      #track-escape-container label {
        /* Fill out the whole container to make the checkbox easier to hit */
        width: 100%;
        height: 100%;
        display: block;
      }

      /*  Code view  */
      #code-view-container {
        min-width: 800px;
        max-width: 1250px;
        width: 80%;
        display: block;
        vertical-align: top;
        margin: 0 auto; /* Center horizontally */
        background-color: #eee;
        border: 1px solid #ddd;
      }
      #code-view-body {
        font-size: 12px;
        line-height: 19px;
        white-space: pre-wrap;
        cursor: default;
        background-color: #fff;
        border-top: 1px solid #ddd;
      }
      #code-view-body li {
        /* Font style applies to the line numbers shown in the code view */
        color: #ddd;
        font-family: arial;
        font-size: 10px;
        min-height: 19px; /* Ensure comfortable line spacing */
      }
      .code-line {
        /* Font style applies to all source code */
        font-family: 'Source Code Pro', monospace;
        font-size: 13px;
        color: gray; /* This is the color of source code comments */
        padding-left: 6px; /* Creates space between line numbers and code */
      }
      .code-line span {
        /* "Default" source code color */
        color: black;
      }
      .code-line span.keyword {
        color: #6c71c4;
      }
      .code-line span.typename {
        color: #b58900;
      }
      #code-view-title {
        font-size: 20pt;
        display: none;
      }
      #code-view-filename {
        font-size: 10pt;
        color: gray;
        display: inline-block;
      }
      #code-view-filename ol {
        list-style-type: none;
      }
      span.highlighted-token {
        color: #073642 !important;
        background-color: #cb4b16;
      }
      span.related-element {
        color: #073642 !important;
        background-color: #cb4b16;
      }


      /*  Type view  */
      #type-view-container {
        position: absolute;
        z-index: 1;
        display: inline-block;
        padding: 4px 4px 4px 4px;
        background-color: #111;
        opacity: 0.9;
        color: white;
      }
      #type-view-table {
        border-collapse: collapse;
      }
      #type-view-table td {
        padding: 2px;
      }
      #type-view-expression-kind {
        color: orange;
      }
      #type-view-storage-location-name {
        /* The storage location text following the AST node kind, shown when
           hovering over an AST node */
        color: gray;
      }
      #type-view-warning {
        /* Warns that the shown AST node is a dynamic call */
        background-color: #dc322f;
        color: black;
        text-align: center;
      }
      .type-view-base-class {}
      .type-view-flag-label {
        padding-right: 6px;
      }
      .type-view-flag-on {
        color: #dc322f;
      }
      .type-view-flag-off {
        color: #268bd2;
      }
      .type-view-next-value {
        color: yellow;
      }
      .type-view-final-value {
        color: gray;
      }
      .type-view-flag-separator {
        font-size: 8pt;
        color: orange;
      }

      /*  Constraint view  */
      #constraint-view-table {
        color: black;
        border-collapse: collapse;
        text-align: left;
        width: 100%;
        height: 100%;
        font-family: arial;
        font-size: 14px;
      }
      #constraint-view-table td {
        vertical-align: center;
      }
      #constraint-view-table li {
        box-sizing: border-box;
      }
      .code-line-with-constraints {
        /* Applies to a list item containing one line of code and the
           constraint view */
        background-color: #ffe;
        outline: 1px solid #ddd;
      }

      .storage-location {
        font-family: monospace;
      }

      a.reference {
      }
      a.reference:hover {
        border-bottom: 1px solid black;
        cursor: pointer;
      }
      a.reference:visited {}

      .constraint-label, .constraint-guard {
        color: #93a1a1;
        padding-left: 4px;
        font-size: 12px;
      }
      .constraint-line-number {
        padding-left: 4px;
        font-size: 10px;
        color: #93a1a1;
        background-color: #eee8d5;
      }
      .constraint-focused {
        animation: 200ms 5 alternate constraint-focused-blinking;
        background-color: #ff5;
        outline: 1px solid #dd5;
      }
      @keyframes constraint-focused-blinking {
        from {
          background-color: inherit;
        }
        to {
          background-color: #ff5;
        }
      }
      .constraint-escape {
        font-style: italic;
      }
      .right {
        text-align: right;
      }

    </style>
  </head>
  <body id="body">
    <div id="file-select" class="splash-screen-box">
      <label for="kernel-file-input">
        Click to upload a .dill file
        <input type="file" id="kernel-file-input" />
      </label>
    </div>

    <div id="loading-screen-container" class="splash-screen-box">
      <table id="loading-screen-table">
        <tr>
          <th style="width: auto;"></th>
          <th style="width: 100px;"></th>
        </tr>
      </table>
    </div>

    <div id="main-content" style="position: absolute;">

      <div id="top-bar">
        <div id="search-input-container">
          <input type="text" id="search-input" placeholder="Fuzzy search (hotkey: q)"/>
          <div id="search-input-suggestions">
            <select id="search-input-select" size="10"></select>
          </div>
        </div>

        <div id="backtracker-container">
          <span id="backtracker-title">Backtracking</span>
          <progress id="backtracker-progress"></progress>
          <input type="button" id="backtracker-reset-button" value="Stop backtracking" />
        </div>

        <div id="track-escape-container">
          <label for="track-escape-checkbox">
            <input type="checkbox" id="track-escape-checkbox"></input>
            Track escape
          </label>
        </div>
      </div>

      <div id="top-bar-filler"></div>

      <div id="code-view-container">
        <div id="code-view-filename"></div>
        <div id="code-view-body"></div>
      </div>

      <table id="constraint-view-table">
        <tr id="constraint-view-header">
          <th style="width: 35%;"></th>
          <th style="width: 10px;"></th>
          <th style="width: 35%;"></th>
          <th style="width: auto;"></th>
        </tr>
      </table>

      <!-- Prevent type view from resizing and scrolling the page -->
      <div id="bottom-filler"></div>
    </div>

    <div id="type-view-container">
      <div id="type-view-warning"></div>
      <span id="type-view-expression-kind"></span>
      <span id="type-view-storage-location-name"></span>
      <table id="type-view-table"></table>
    </div>

    <div id="debug-box"/>
    <script type="application/javascript" src="laboratory.js"></script>

  </body>
</html>
